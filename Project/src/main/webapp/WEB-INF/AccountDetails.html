<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Account</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" >
<link rel="stylesheet" type="text/css" media="all"
	href="../CSS/style.css" th:href="@{/CSS/style.css}" />
</head>
<body class="text-center">


	<div class="fixed-top" align="right">
		<a th:href="@{/Logout}">Logout</a>
	</div>
	
	
	
	<div>
	<h1>List of transaction </h1> 
	<h1 th:text="${session.user.name + ' ' + session.user.surname }"></h1>
	<h1 th:text="${'Bank account:' + id }"></h1>
	<h1> <span th:text = "${' Balance:' + balance }"></span>&euro;</h1>
	
	
	<div th:if="${#lists.isEmpty(transactions)}">No transactions found.</div>
	
	<div th:if="${not #lists.isEmpty(transactions)}">
	<p>	
		Here are your transactions.
	</p>
	<table class="table">
  		<thead class="thead-dark">
			<tr>
				<th scope="col">From/To</th>
				<th scope="col">Details</th>
				<th scope="col">Transaction ID</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="t : ${transactions}" > 
				
				<td>
				 
				 <span th:text=" ${t.sourceAccount == id} ? 'To' : 'From' "></span>
				 
				 
				 <span th:each ="a : ${accounts}">
				 	<span th:text=" ${t.sourceAccount == id && t.destinationAccount == a.id} ? ${a.username} : ''"></span>
				 	<span th:text=" ${t.destinationAccount == id && t.sourceAccount== a.id} ? ${a.username} : '' "></span>
				 </span>
				 
				 <span th:text=" ${t.sourceAccount == id} ? ${'(' + t.destinationAccount + ')'}: ${'(' + t.sourceAccount + ')'}"></span>
				 </td>
				
				<td> <p class="receive"> Date: <span th:text="${t.date}"></span> </p>
				
				<p th:style=" ${t.sourceAccount == id} ? 'color:red' : 'color:green' "> 
				Amount: 
				<span th:text=" ${t.sourceAccount == id} ? '-' : '+' "></span>
				<span><span th:text="${t.amount}"></span>&euro;</span>
				</p>
				
				<p > Description: <span th:text="${t.description}"></span></p></td>
				
				<td th:text="${t.id}"></td>
			</tr>
		</tbody>
	</table>
	</div>
	
	</div>
	
	<div>
	<div th:if="${balance<=0}">Recharge your bank account before you transfer money to another account. </div>
	<div th:if="${balance>0}">
		<p>Complete the form to make a transaction</p>
		<form action="#" th:action="@{/CheckTransaction}" method="POST" class="form-signin border">
			<fieldset>
				<label for ="idUser">Recipient User Code:</label>
				<input type="text" name="idUser" class="form-control" required placeholder="Insert username recipient"/>
				<br>	
				<label for ="idAccount">Recipient bank account:</label>
					<input type="number" name="idAccount" class="form-control" min=0 required placeholder="Insert bank account recipient"/>
				<br>
				<label for ="description">Reason for payment:</label>
				<input type="text" name="description" class="form-control" required placeholder="Insert a description"/>
				
				<br>
				<label for =amount>Amount: </label>
					<input type="number" name="amount" min=0 class="form-control" required step="0.01" placeholder="Insert an amount"/>
				
					 <input type="hidden" name="idThis" th:value="${id}"/>
				<br>
				<br>	  
				<input type="submit" value="Send" class="btn btn-lg btn-primary btn-block">
				<p th:text=" ${msg}"></p>
			</fieldset>
		</form>
	</div>
		<br>
		<br>
		<form action="#" th:action="@{/Home}" method="POST">
			<input  class="btn btn-primary" type="submit" value="Back" >
		</form>
	</div>
</body>
</html>